{
	debug
	auto_https off # Disable automatic HTTPS for internal services
}

http://localhost {
	# Public routes (no authentication)
	handle /user/login {
		reverse_proxy demo-user-service-app-1:1323
	}

	# Protected routes
	handle {
		forward_auth demo-user-service-app-1:1323 {
			uri /user/validate
			copy_headers Authorization
		}

		handle_path /cart/* {
			reverse_proxy demo-cart-service-app-1:1323
		}

		handle_path /shop-product/* {
			reverse_proxy demo-shop-product-service-app-1:1323
		}

		# Catch all unmatched routes
		handle {
			respond "Gateway - Endpoint Not Found" 404
		}
	}
}
